}
library("xlsx") #Read/Write excel files
library(ggrepel) #plots
names(data)
cols <- c("up_regulated" = "#cc0000", "down_regulated" = "#009933", "NS" = "darkgrey", "significant" = "#ffff99")
path_fig <- paste0("results/volcano_plot.pdf")
pdf(path_fig, height = 5, width = 6)
pdf("volcano_plot.pdf", height = 5, width = 6)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC))
+ geom_point(size=3, alpha = 3, na.rm = T)
pdf("volcano_plot.pdf", height = 5, width = 6)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=3, alpha = 3, na.rm = T)
+ scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000"))
pdf("volcano_plot.pdf", height = 5, width = 6)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=3, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000"))
+ theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18))
pdf("volcano_plot.pdf", height = 5, width = 6)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=3, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18))
+ labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)")
pdf("volcano_plot.pdf", height = 5, width = 6)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=3, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18))
+ labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)")
pdf("volcano_plot.pdf", height = 5, width = 6)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=3, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)")
+ xlim(-1.8, 1)
pdf("volcano_plot.pdf", height = 5, width = 6)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=3, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-1.8, 1) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
knitr::opts_knit$set(root.dir = normalizePath("C:\\Users\\beasav\\OneDrive - KI.SE\\Bioinformatics\\1. Our data\\SARS-CoV-2"))
pdf("volcano_plot.pdf", height = 5, width = 6)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=2, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-1.8, 1) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
library("xlsx") #Read/Write excel files
library(ggrepel) #plots
pdf("volcano_plot.pdf", height = 5, width = 6)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=2, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-1.8, 1) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 6)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-1.8, 1) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 6)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 2, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-1.8, 1) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-1.8, 1) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFCA, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-1.8, 1) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-1.8, 1) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=10),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-1.8, 1) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-1.8, 1) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=12),legend.text=element_text(size=5),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-1.8, 1) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x =logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=12),legend.text=element_text(size=5),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-1.8, 1) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-1.8, 2) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-10, 10) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-3, 3) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name),size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=4,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2,label.size = 0.5, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2,label.size = 3, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2,label.size = 30, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + ylim(0, 30) + geom_text_repel(aes(label = Gene_name), size=2,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + ylim(0, 5) + geom_text_repel(aes(label = Gene_name), size=2,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + ylim(0, 4.5) + geom_text_repel(aes(label = Gene_name), size=2,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + ylim(1, 4.5) + geom_text_repel(aes(label = Gene_name), size=2,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=18),axis.text.x=element_text(size=18)) + labs(x="Log2 Fold Change",y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=15),axis.text.x=element_text(size=15)) + labs(x="Log2 Fold Change", y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=3,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=5),axis.text.x=element_text(size=5)) + labs(x="Log2 Fold Change", y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2.5,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=15),axis.title.x=element_text(size=15),
axis.text.y=element_text(size=10),axis.text.x=element_text(size=10)) + labs(x="Log2 Fold Change", y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2.5,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=10),axis.title.x=element_text(size=10),
axis.text.y=element_text(size=10),axis.text.x=element_text(size=10)) + labs(x="Log2 Fold Change", y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2.5,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(30,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=10),axis.title.x=element_text(size=10),
axis.text.y=element_text(size=10),axis.text.x=element_text(size=10)) + labs(x="Log2 Fold Change", y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2.5,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=6),
legend.key.size=unit(10,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=10),axis.title.x=element_text(size=10),
axis.text.y=element_text(size=10),axis.text.x=element_text(size=10)) + labs(x="Log2 Fold Change", y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2.5,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=5),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=10),axis.title.x=element_text(size=10),
axis.text.y=element_text(size=10),axis.text.x=element_text(size=10)) + labs(x="Log2 Fold Change", y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2.5,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=15),legend.text=element_text(size=1),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=10),axis.title.x=element_text(size=10),
axis.text.y=element_text(size=10),axis.text.x=element_text(size=10)) + labs(x="Log2 Fold Change", y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2.5,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=10),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=10),axis.title.x=element_text(size=10),
axis.text.y=element_text(size=10),axis.text.x=element_text(size=10)) + labs(x="Log2 Fold Change", y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2.5,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.jpeg", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=10),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=10),axis.title.x=element_text(size=10),
axis.text.y=element_text(size=10),axis.text.x=element_text(size=10)) + labs(x="Log2 Fold Change", y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2.5,label.size = 0.1, color = "black")
vol
dev.off()
pdf("volcano_plot.jpeg", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=10),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=10),axis.title.x=element_text(size=10),
axis.text.y=element_text(size=10),axis.text.x=element_text(size=10)) + labs(x="Log2 Fold Change", y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2.5, color = "black")
vol
dev.off()
pdf("volcano_plot.pdf", height = 5, width = 7)
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=10),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=10),axis.title.x=element_text(size=10),
axis.text.y=element_text(size=10),axis.text.x=element_text(size=10)) + labs(x="Log2 Fold Change", y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2.5, color = "black")
vol
dev.off()
condition <- factor(c(rep("Mock", 3), rep("24hpi", 3), rep("48hpi", 3)), levels = c("Mock", "24hpi", "48hpi"))
pca_data <- data.frame(group = condition, t(input[,-c(1, 11:17)]))
c <- merge(raw_data,data, by= "Gene name", all.x = TRUE)
c <- merge(raw_data,data, by= "Gene_name", all.x = TRUE)
View(c)
View(c)
rm(c)
condition <- factor(c(rep("Mock", 3), rep("24hpi", 3), rep("48hpi", 3)), levels = c("Mock", "24hpi", "48hpi"))
pca_data <- data.frame(group = condition, t(data[,-c(1, 11:17)]))
View(pca_data)
View(pca_data)
View(factor)
View(condition)
condition <- factor(c(rep("Mock", 3), rep("24hpi", 3), rep("48hpi", 3)), levels = c("Mock", "24hpi", "48hpi"))
pca_data <- data.frame(group = condition, t(data[,-c(1, 11:17)]))
pca_data[is.na(pca_data)] <-  0
pca <- prcomp(pca_data[,-1])
rm(pca_data)
rm(condition)
rm(path_fig)
rm(cols)
pdf("volcano_plot.pdf", height = 5, width = 7)
pdf("volcano_plot.pdf", height = 5, width = 7)
vol <- ggplot(data, aes(x = logFC, y = -log10(adj.P.Val), colour = logFC)) + geom_point(size=1, alpha = 3, na.rm = T) + scale_color_gradientn(colors = c("#003300", "#325b32","#668466","#ffffcc","#670000")) + theme(legend.title=element_text(size=10),legend.text=element_text(size=6),
legend.key.size=unit(0.7,"line"),plot.title = element_text(hjust = 0.5),
axis.title.y=element_text(size=10),axis.title.x=element_text(size=10),
axis.text.y=element_text(size=10),axis.text.x=element_text(size=10)) + labs(x="Log2 Fold Change", y="-log10 (adj.P.Val)") + xlim(-2.5, 2.5) + geom_text_repel(aes(label = Gene_name), size=2.5, color = "black")
vol
dev.off()
data$Gene_name != "NS"
sig_gene_names <- data$Gene_name[data$Gene_name != "NS"]
sig_gene_names <- raw_data$Gene_name[data$Gene_name != "NS"]
sig_gene_names
}
sig_gene_names <- raw_data$Gene_name[data$Gene_name != "NS"] #Gene names are stored in raw data
sig_gene_names
View(raw_data)
View(raw_data)
sig_gene_names <- raw_data$Gene_name[data$color != "NS"] #Gene names are stored in raw data
sig_gene_names
View(data)
View(data)
write(sig_Gene_names, "dif_expressed genes.txt")
sig_Gene_names <- raw_data$Gene_name[data$color != "NS"] #Gene names are stored in raw data; data$color indicates significance
rm("sig_gene_names")
write(sig_Gene_names, "dif_expressed genes.txt")
enrichr <- read.delim(Enrichr_BioPlanet_2019_table.txt)
enrichr <- read.delim("Enrichr_BioPlanet_2019_table.txt")
View(enrichr)
View(enrichr)
covid <- bitr(sig_Gene_names, fromType = "SYMBOL", toType = c("ENTREZID"), OrgDb = org.Hs.eg.db)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("clusterProfiler")
covid <- bitr(sig_Gene_names, fromType = "SYMBOL", toType = c("ENTREZID"), OrgDb = org.Hs.eg.db)
covid <- bitr::bitr(sig_Gene_names, fromType = "SYMBOL", toType = c("ENTREZID"), OrgDb = org.Hs.eg.db)
covid <- bitr(sig_Gene_names, fromType = "SYMBOL", toType = c("ENTREZID"), OrgDb = org.Hs.eg.db)
library("xlsx") #Read/Write excel files
library(ggrepel) #plots
library(clusterProfiler)
covid <- bitr(sig_Gene_names, fromType = "SYMBOL", toType = c("ENTREZID"), OrgDb = org.Hs.eg.db)
library("xlsx") #Read/Write excel files
library(ggrepel) #plots
library(clusterProfiler)
library(org.Hs.eg.db)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("org.Hs.eg.db")
library("xlsx") #Read/Write excel files
library(ggrepel) #plots
library(clusterProfiler)
library(org.Hs.eg.db)
covid <- bitr(sig_Gene_names, fromType = "SYMBOL", toType = c("ENTREZID"), OrgDb = org.Hs.eg.db)
covid <- bitr(sig_Gene_names, fromType = "SYMBOL", toType = c("ENTREZID"), OrgDb = org.Hs.eg.db)
View(covid)
View(covid)
rm(covid)
samples <- list( COV248 = covid$ENTREZID)
samples <- bitr(sig_Gene_names, fromType = "SYMBOL", toType = c("ENTREZID"), OrgDb = org.Hs.eg.db)
res <- compareCluster(samples, fun="enrichPathway")
res <- compareCluster(samples, fun = "enrichPathway" )
covid <- bitr(sig_Gene_names, fromType = "SYMBOL", toType = c("ENTREZID"), OrgDb = org.Hs.eg.db)
samples <- covid$ENTREZID
res <- compareCluster(samples, fun = "enrichPathway" )
require(ReactomePA)
res <- compareCluster(samples, fun = "enrichPathway" )
samples <- list(covid$ENTREZID)
require(ReactomePA)
res <- compareCluster(samples, fun = "enrichPathway" )
require(ReactomePA)
res <- compareCluster(samples, fun = "enrichPathway" )
require(ReactomePA)
res <- compareCluster(samples, fun = "enrichPathway" )
require(ReactomePA)
res <- compareCluster(samples, fun = "enrichPathway" )
View(samples)
View(samples)
samples <- covid$ENTREZID
res <- compareCluster(samples, fun = "enrichPathway" )
res <- compareCluster(samples, fun = "groupGO" )
res <- compareCluster(samples, fun = "enrichGO" )
res <- compareCluster(samples, fun = "enrichKEGG" )
res <- compareCluster(list(covid$ENTREZID), fun = "enrichKEGG" )
res <- compareCluster(list(covid$ENTREZID), fun="enrichPathway")
pdf("results/Comparison_pathways_huh7_virus.pdf", width = 12)
pdf("Comparison_pathways.pdf", width = 12)
dotplot(enrichr$Term~enricher$Adjusted.P.value|"Covid UN_48")
pdf("Comparison_pathways.pdf", width = 12)
dotplot(enrichr$Term~enricher$Adjusted.P.value)
res <- compareCluster(COV248 =list(covid$ENTREZID), fun = "enrichPathway")
res <- compareCluster(COV248 =list(covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
res <- compareCluster(COV248 =list(covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(COV248 =list(covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(COV248 =list(covid$ENTREZID), fun = "enrichPathway")
library("xlsx") #Read/Write excel files
library(ggrepel) #plots
library(clusterProfiler)
library(org.Hs.eg.db)
require(reactome.db)
require(ReactomePA)
res <- compareCluster(COV248 =list(covid$ENTREZID), fun = "enrichPathway")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("clusterProfiler")
library("xlsx") #Read/Write excel files
library(ggrepel) #plots
library(clusterProfiler)
library(org.Hs.eg.db)
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("reactome.db")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ReactomePA")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("ReactomePA")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
#require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
require(reactome.db)
require(ReactomePA)
res <- compareCluster(list(COV248 = covid$ENTREZID), fun = "enrichPathway")
pdf("Comparison_pathways.pdf", width = 12)
dotplot(res)
dev.off()
View(res)
View(res)
