cexCol = 1.2,
srtCol = 45,
labCol = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"),
# color key + density info
key = FALSE,
#keysize = 5,
#density.info="none",
#denscol=tracecol,
#symkey = any(x < 0, na.rm=TRUE) || symbreaks,
#densadj = 0.25,
#key.title = NA,
#key.xlab = NA, #"logFC",
#key.ylab = NULL,
#key.xtickfun = NULL,
#key.ytickfun = NULL,
#key.par = list(mar=c(10,10,3,0)),
# plot layout
#lmat = 1,
lhei = c(0.1, 15),
lwid = c(1, 5),
margins=c(6,6)
)
library("gplots")
jpeg("Heatmat_coronavirus disease_clean.jpeg", width = 600, height = 1500)
heatmap.2(as.matrix(data_clean),
Rowv = FALSE,
Colv = FALSE,
dendrogram = "none",
tracecol=NA,
na.color = "#E0E0E0",
scale = "none",
col = colorRampPalette(c("#003300", "#325b32","white", "#F2490C", "#670000")),
#Axis labels
cexRow = 0.7,
cexCol = 1.2,
srtCol = 45,
labCol = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"),
# color key + density info
key = FALSE,
#keysize = 5,
#density.info="none",
#denscol=tracecol,
#symkey = any(x < 0, na.rm=TRUE) || symbreaks,
#densadj = 0.25,
#key.title = NA,
#key.xlab = NA, #"logFC",
#key.ylab = NULL,
#key.xtickfun = NULL,
#key.ytickfun = NULL,
#key.par = list(mar=c(10,10,3,0)),
# plot layout
#lmat = 1,
lhei = c(0.1, 15),
lwid = c(1, 5),
margins=c(6,6)
)
dev.off()
library("gplots")
png("Heatmat_coronavirus disease_clean.png", width = 600, height = 1500)
heatmap.2(as.matrix(data_clean),
Rowv = FALSE,
Colv = FALSE,
dendrogram = "none",
tracecol=NA,
na.color = "#E0E0E0",
scale = "none",
col = colorRampPalette(c("#003300", "#325b32","white", "#F2490C", "#670000")),
#Axis labels
cexRow = 0.7,
cexCol = 1.2,
srtCol = 45,
labCol = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"),
# color key + density info
key = FALSE,
#keysize = 5,
#density.info="none",
#denscol=tracecol,
#symkey = any(x < 0, na.rm=TRUE) || symbreaks,
#densadj = 0.25,
#key.title = NA,
#key.xlab = NA, #"logFC",
#key.ylab = NULL,
#key.xtickfun = NULL,
#key.ytickfun = NULL,
#key.par = list(mar=c(10,10,3,0)),
# plot layout
#lmat = 1,
lhei = c(0.1, 15),
lwid = c(1, 5),
margins=c(6,6)
)
dev.off()
library("gplots")
png("Heatmat_coronavirus disease_clean.png", width = 1200, height = 3000)
heatmap.2(as.matrix(data_clean),
Rowv = FALSE,
Colv = FALSE,
dendrogram = "none",
tracecol=NA,
na.color = "#E0E0E0",
scale = "none",
col = colorRampPalette(c("#003300", "#325b32","white", "#F2490C", "#670000")),
#Axis labels
cexRow = 0.7,
cexCol = 1.2,
srtCol = 45,
labCol = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"),
# color key + density info
key = FALSE,
#keysize = 5,
#density.info="none",
#denscol=tracecol,
#symkey = any(x < 0, na.rm=TRUE) || symbreaks,
#densadj = 0.25,
#key.title = NA,
#key.xlab = NA, #"logFC",
#key.ylab = NULL,
#key.xtickfun = NULL,
#key.ytickfun = NULL,
#key.par = list(mar=c(10,10,3,0)),
# plot layout
#lmat = 1,
lhei = c(0.1, 15),
lwid = c(1, 5),
margins=c(6,6)
)
dev.off()
library("gplots")
png("Heatmat_coronavirus disease_clean.png", width = 1200, height = 3000)
heatmap.2(as.matrix(data_clean),
Rowv = FALSE,
Colv = FALSE,
dendrogram = "none",
tracecol=NA,
na.color = "#E0E0E0",
scale = "none",
col = colorRampPalette(c("#003300", "#325b32","white", "#F2490C", "#670000")),
#Axis labels
cexRow = 0.7,
cexCol = 1.2,
srtCol = 45,
labCol = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"),
# color key + density info
key = FALSE,
#keysize = 5,
#density.info="none",
#denscol=tracecol,
#symkey = any(x < 0, na.rm=TRUE) || symbreaks,
#densadj = 0.25,
#key.title = NA,
#key.xlab = NA, #"logFC",
#key.ylab = NULL,
#key.xtickfun = NULL,
#key.ytickfun = NULL,
#key.par = list(mar=c(10,10,3,0)),
# plot layout
#lmat = 1,
lhei = c(0.1, 15),
lwid = c(0.5, 5),
margins=c(6,6)
)
dev.off()
library("gplots")
png("Heatmat_coronavirus disease_clean.png", width = 1000, height = 3000)
heatmap.2(as.matrix(data_clean),
Rowv = FALSE,
Colv = FALSE,
dendrogram = "none",
tracecol=NA,
na.color = "#E0E0E0",
scale = "none",
col = colorRampPalette(c("#003300", "#325b32","white", "#F2490C", "#670000")),
#Axis labels
cexRow = 0.7,
cexCol = 1.2,
srtCol = 45,
labCol = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"),
# color key + density info
key = FALSE,
#keysize = 5,
#density.info="none",
#denscol=tracecol,
#symkey = any(x < 0, na.rm=TRUE) || symbreaks,
#densadj = 0.25,
#key.title = NA,
#key.xlab = NA, #"logFC",
#key.ylab = NULL,
#key.xtickfun = NULL,
#key.ytickfun = NULL,
#key.par = list(mar=c(10,10,3,0)),
# plot layout
#lmat = 1,
lhei = c(0.1, 15),
lwid = c(0.5, 5),
margins=c(6,6)
)
dev.off()
library("gplots")
png("Heatmat_coronavirus disease_clean.png", width = 500, height = 1500)
heatmap.2(as.matrix(data_clean),
Rowv = FALSE,
Colv = FALSE,
dendrogram = "none",
tracecol=NA,
na.color = "#E0E0E0",
scale = "none",
col = colorRampPalette(c("#003300", "#325b32","white", "#F2490C", "#670000")),
#Axis labels
cexRow = 0.7,
cexCol = 1.2,
srtCol = 45,
labCol = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"),
# color key + density info
key = FALSE,
#keysize = 5,
#density.info="none",
#denscol=tracecol,
#symkey = any(x < 0, na.rm=TRUE) || symbreaks,
#densadj = 0.25,
#key.title = NA,
#key.xlab = NA, #"logFC",
#key.ylab = NULL,
#key.xtickfun = NULL,
#key.ytickfun = NULL,
#key.par = list(mar=c(10,10,3,0)),
# plot layout
#lmat = 1,
lhei = c(0.1, 15),
lwid = c(0.5, 5),
margins=c(6,6)
)
dev.off()
library("gplots")
png("Heatmat_coronavirus disease_clean.png", width = 500, height = 1500)
heatmap.2(as.matrix(data_clean),
Rowv = FALSE,
Colv = FALSE,
dendrogram = "none",
tracecol=NA,
na.color = "#E0E0E0",
scale = "none",
col = colorRampPalette(c("#003300", "#325b32","white", "#F2490C", "#670000")),
#Axis labels
cexRow = 1,
cexCol = 1.5,
srtCol = 45,
labCol = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"),
# color key + density info
key = FALSE,
#keysize = 5,
#density.info="none",
#denscol=tracecol,
#symkey = any(x < 0, na.rm=TRUE) || symbreaks,
#densadj = 0.25,
#key.title = NA,
#key.xlab = NA, #"logFC",
#key.ylab = NULL,
#key.xtickfun = NULL,
#key.ytickfun = NULL,
#key.par = list(mar=c(10,10,3,0)),
# plot layout
#lmat = 1,
lhei = c(0.1, 15),
lwid = c(0.5, 5),
margins=c(6,6)
)
dev.off()
library("gplots")
png("Heatmat_coronavirus disease_clean.png", width = 500, height = 1500)
heatmap.2(as.matrix(data_clean),
Rowv = FALSE,
Colv = FALSE,
dendrogram = "none",
tracecol=NA,
na.color = "#E0E0E0",
scale = "none",
col = colorRampPalette(c("#003300", "#325b32","white", "#F2490C", "#670000")),
#Axis labels
cexRow = 1,
cexCol = 1.5,
srtCol = 45,
labCol = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"),
# color key + density info
key = FALSE,
#keysize = 5,
#density.info="none",
#denscol=tracecol,
#symkey = any(x < 0, na.rm=TRUE) || symbreaks,
#densadj = 0.25,
#key.title = NA,
#key.xlab = NA, #"logFC",
#key.ylab = NULL,
#key.xtickfun = NULL,
#key.ytickfun = NULL,
#key.par = list(mar=c(10,10,3,0)),
# plot layout
#lmat = 1,
lhei = c(0.1, 15),
lwid = c(0.5, 5),
margins=c(9,6)
)
dev.off()
library("gplots")
png("Heatmat_coronavirus disease_clean.png", width = 500, height = 1500)
heatmap.2(as.matrix(data_clean),
Rowv = FALSE,
Colv = FALSE,
dendrogram = "none",
tracecol=NA,
na.color = "#E0E0E0",
scale = "none",
col = colorRampPalette(c("#003300", "#325b32","white", "#F2490C", "#670000")),
#Axis labels
cexRow = 1,
cexCol = 1.5,
srtCol = 45,
labCol = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"),
# color key + density info
key = FALSE,
#keysize = 5,
#density.info="none",
#denscol=tracecol,
#symkey = any(x < 0, na.rm=TRUE) || symbreaks,
#densadj = 0.25,
#key.title = NA,
#key.xlab = NA, #"logFC",
#key.ylab = NULL,
#key.xtickfun = NULL,
#key.ytickfun = NULL,
#key.par = list(mar=c(10,10,3,0)),
# plot layout
#lmat = 1,
lhei = c(0.1, 15),
lwid = c(0.5, 5),
margins=c(7.5,6)
)
dev.off()
library("gplots")
png("Heatmat_coronavirus disease_clean.png", width = 500, height = 1500)
heatmap.2(as.matrix(data_clean),
Rowv = FALSE,
Colv = FALSE,
dendrogram = "none",
tracecol=NA,
na.color = "#E0E0E0",
scale = "none",
col = colorRampPalette(c("#003300", "#325b32","white", "#F2490C", "#670000")),
#Axis labels
cexRow = 1,
cexCol = 1.5,
srtCol = 45,
labCol = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"),
# color key + density info
key = FALSE,
#keysize = 5,
#density.info="none",
#denscol=tracecol,
#symkey = any(x < 0, na.rm=TRUE) || symbreaks,
#densadj = 0.25,
#key.title = NA,
#key.xlab = NA, #"logFC",
#key.ylab = NULL,
#key.xtickfun = NULL,
#key.ytickfun = NULL,
#key.par = list(mar=c(10,10,3,0)),
# plot layout
#lmat = 1,
lhei = c(0.1, 15),
lwid = c(0.5, 5),
margins=c(7,6)
)
dev.off()
rm(list=ls())
knitr::opts_knit$set(root.dir = normalizePath("C:\\Users\\beasav\\OneDrive - KI.SE\\Bioinformatics\\Thesis"))
CoV2 <- read.xlsx("SARS-CoV-2 UN_48H\\Data and figures\\Enrichr_KEGG_2021_sig.xlsx",1)
CoV1 <- read.xlsx("SARS-CoV-1 UN_48H\\Data and figures\\Enrichr_KEGG_2021_sig.xlsx",1)
MERS <- read.xlsx("MERS-CoV UN_24H\\Data and figures\\Enrichr_KEGG_2021_sig.xlsx",1)
CoV2_CoV1 = c()
CoV2_MERS = c()
CoV1_MERS = c()
All = c()
for (i in 1:nrow(CoV2)){
if (CoV2$Term[i] %in% CoV1$Term){
CoV2_CoV1 = c(CoV2_CoV1, CoV2$Term[i])
}
if (CoV2$Term[i] %in% MERS$Term){
CoV2_MERS = c(CoV2_MERS, CoV2$Term[i])
}
}
for (i in 1:nrow(CoV1)){
if (CoV1$Term[i] %in% MERS$Term){
CoV1_MERS = c(CoV1_MERS, CoV1$Term[i])
}
}
for (i in 1:length(CoV1_MERS)){
if (CoV1_MERS[i] %in% CoV2_MERS && CoV1_MERS[i] %in% CoV2_MERS){
All = c(All, CoV1_MERS[i])
}
}
rm(i)
CoV2_common <- data.frame(Term = c(), Overlap = c(), Adjusted.P.value = c(), Genes = c())
CoV1_common <- data.frame(Term = c(), Overlap = c(), Adjusted.P.value = c(), Genes = c())
MERS_common <- data.frame(Term = c(), Overlap = c(), Adjusted.P.value = c(), Genes = c())
for (i in match(All, CoV2$Term)){
C2 <- data.frame(Term = CoV2$Term[i], Overlap = CoV2$Overlap[i], Adjusted.P.value = CoV2$Adjusted.P.value[i], Genes = CoV2$Genes[i])
CoV2_common <- rbind(CoV2_common, C2)
}
for (i in match(All, CoV1$Term)){
C1 <- data.frame(Term = CoV1$Term[i], Overlap = CoV1$Overlap[i], Adjusted.P.value = CoV1$Adjusted.P.value[i], Genes = CoV1$Genes[i])
CoV1_common <- rbind(CoV1_common, C1)
}
for (i in match(All, MERS$Term)){
CM <- data.frame(Term = MERS$Term[i], Overlap = MERS$Overlap[i], Adjusted.P.value = MERS$Adjusted.P.value[i], Genes = MERS$Genes[i])
MERS_common <- rbind(MERS_common, CM)
}
#To make it the right order for ggplot
CoV2_common$position <- "SARS-CoV-2"
CoV2$Term <- factor(CoV2$Term, levels = CoV2$Term )
CoV1_common$position <- "SARS-CoV-1"
CoV1$Term <- factor(CoV1$Term, levels = CoV1$Term )
MERS_common$position <- "MERS-CoV"
MERS$Term <- factor(MERS$Term, levels = MERS$Term )
rm(C2)
rm(C1)
rm(CM)
plot <- rbind(CoV2_common, CoV1_common, MERS_common)
plot$position <- factor(plot$position, levels = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"))
pdf("Common_pathways_enrichr_KEGG_2021_dot.pdf", width = 6, height = 2)
p<-ggplot(plot, aes(x = position, y = Term)) + geom_point(aes(size = Overlap, color = Adjusted.P.value)) + scale_color_gradientn(colors = c("#668466", "#CC0000")) + theme_classic() + theme(axis.title.y=element_blank(), axis.title.x=element_blank(), axis.ticks.x=element_blank(), legend.key.size = unit(0.4, 'cm'), legend.title = element_text(size = 9),  legend.text = element_text(size = 7))
p
dev.off()
rm(p)
rm(plot)
plot <- rbind(CoV2_common, CoV1_common, MERS_common)
plot$position <- factor(plot$position, levels = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"))
pdf("Common_pathways_enrichr_KEGG_2021_dot.pdf", width = 6, height = 3)
p<-ggplot(plot, aes(x = position, y = Term)) + geom_point(aes(size = Overlap, color = Adjusted.P.value)) + scale_color_gradientn(colors = c("#668466", "#CC0000")) + theme_classic() + theme(axis.title.y=element_blank(), axis.title.x=element_blank(), axis.ticks.x=element_blank(), legend.key.size = unit(0.4, 'cm'), legend.title = element_text(size = 9),  legend.text = element_text(size = 7))
p
dev.off()
rm(p)
rm(plot)
plot <- rbind(CoV2_common, CoV1_common, MERS_common)
plot$position <- factor(plot$position, levels = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"))
pdf("Common_pathways_enrichr_KEGG_2021_dot.pdf", width = 6, height = 4)
p<-ggplot(plot, aes(x = position, y = Term)) + geom_point(aes(size = Overlap, color = Adjusted.P.value)) + scale_color_gradientn(colors = c("#668466", "#CC0000")) + theme_classic() + theme(axis.title.y=element_blank(), axis.title.x=element_blank(), axis.ticks.x=element_blank(), legend.key.size = unit(0.4, 'cm'), legend.title = element_text(size = 9),  legend.text = element_text(size = 7))
p
dev.off()
rm(p)
rm(plot)
plot <- rbind(CoV2_common, CoV1_common, MERS_common)
plot$position <- factor(plot$position, levels = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"))
pdf("Common_pathways_enrichr_KEGG_2021_dot.pdf", width = 6, height = 3)
p<-ggplot(plot, aes(x = position, y = Term)) +
geom_point(aes(size = Overlap, color = Adjusted.P.value)) +
scale_color_gradientn(colors = c("#668466", "#CC0000")) +
theme_classic() +
theme(axis.title.y=element_blank(), axis.title.x=element_blank(), axis.ticks.x=element_blank(), legend.key.size = unit(0.2, 'cm'), legend.title = element_text(size = 9),  legend.text = element_text(size = 7))
p
dev.off()
rm(p)
rm(plot)
plot <- rbind(CoV2_common, CoV1_common, MERS_common)
plot$position <- factor(plot$position, levels = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"))
pdf("Common_pathways_enrichr_KEGG_2021_dot.pdf", width = 6, height = 3)
p<-ggplot(plot, aes(x = position, y = Term)) +
geom_point(aes(size = Overlap, color = Adjusted.P.value)) +
scale_color_gradientn(colors = c("#668466", "#CC0000")) +
theme_classic() +
theme(axis.title.y=element_blank(), axis.title.x=element_blank(), axis.ticks.x=element_blank(), legend.key.size = unit(0.3, 'cm'), legend.title = element_text(size = 9),  legend.text = element_text(size = 7))
p
dev.off()
rm(p)
rm(plot)
plot <- rbind(CoV2_common, CoV1_common, MERS_common)
plot$position <- factor(plot$position, levels = c("SARS-CoV-2", "SARS-CoV-1", "MERS-CoV"))
pdf("Common_pathways_enrichr_KEGG_2021_dot.pdf", width = 6, height = 3)
p<-ggplot(plot, aes(x = position, y = Term)) +
geom_point(aes(size = Overlap, color = Adjusted.P.value)) +
scale_color_gradientn(colors = c("#668466", "#CC0000")) +
theme_classic() +
theme(axis.title.y=element_blank(), axis.title.x=element_blank(), axis.ticks.x=element_blank(), legend.key.size = unit(0.3, 'cm'), legend.title = element_text(size = 8),  legend.text = element_text(size = 6))
p
dev.off()
rm(p)
rm(plot)
CoV2_cytoscape <- read.xlsx("STRING\\CoV2_cytoscape_table_filtered.xlsx",1)
CoV1_cytoscape <- read.xlsx("STRING\\CoV1_cytoscape_table_filtered.xlsx",1)
MERS_cytoscape <- read.xlsx("STRING\\MERS_cytoscape_table_filtered.xlsx",1)
for (i in 1:nrow(MERS_cytoscape)){
for (l in 1:nrow(MERS_abundance)){
if (MERS_cytoscape$display.name[i] == MERS_abundance$Gene_name[l]){
MERS_cytoscape$adj.P.Val[i] <- MERS_abundance$adj.P.Val[l]
MERS_cytoscape$logFC[i] <- MERS_abundance$logFC[l]
}
}
}
CoV2_abundance <- read.xlsx("SARS-CoV-2 UN_48H\\Data and figures\\CoV2_UN_48_filtered.xlsx",1)
CoV1_abundance <- read.xlsx("SARS-CoV-1 UN_48H\\Data and figures\\CoV1_UN_48_filtered.xlsx",1)
MERS_abundance <- read.xlsx("MERS-CoV UN_24H\\Data and figures\\MERS_UN_24_filtered.xlsx",1)
MERS_abundance <- read.xlsx("MERS-CoV UN_24H\\Data and figures\\MERS_UN_24_filtered.xlsx",1)
for (i in 1:nrow(MERS_cytoscape)){
for (l in 1:nrow(MERS_abundance)){
if (MERS_cytoscape$display.name[i] == MERS_abundance$Gene_name[l]){
MERS_cytoscape$adj.P.Val[i] <- MERS_abundance$adj.P.Val[l]
MERS_cytoscape$logFC[i] <- MERS_abundance$logFC[l]
}
}
}
View(MERS_cytoscape)
View(MERS_cytoscape)
write.xlsx(MERS_cytoscape, "STRING\\MERS_cytoscape_table.xlsx", col.names = TRUE, row.names = FALSE)
write.xlsx(MERS_cytoscape, "STRING\\MERS_cytoscape_table.xlsx", col.names = TRUE, row.names = FALSE)
